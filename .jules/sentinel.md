## 2026-02-15 - SQL Injection and Credential Exposure
**Vulnerability:** SQL injection in `get_availability` via dynamic table names and credential exposure in logs in `gartan_fetch.py`.
**Learning:** Dynamic table names in SQL queries cannot be parameterized directly in SQLite, leading to f-string interpolation which is flagged by Bandit and Sourcery. Additionally, "temporary" debug print statements can easily be left in code, exposing sensitive environment variables like usernames. Some static analysis tools (Sourcery) are extremely strict about any dynamic SQL string construction, including safe ones like building `IN` clause placeholders.
**Prevention:** Use an explicit whitelist or hardcoded query mapping for dynamic table/column names. For `IN` clauses, if performance is not critical, loops with parameterized queries can bypass strict scanner blocks. Always ensure `lxml` is in `requirements.txt` if using it with `BeautifulSoup`. Check for `None` sessions in network-dependent functions to avoid `AttributeError`.
