## 2026-02-22 - SQL Injection and Log Leakage Hardening
**Vulnerability:** String interpolation of table names in SQL queries and logging of sensitive response bodies (including credentials/session info) in error logs.
**Learning:** Even when parameters are not directly user-controlled in the current routes, string-based SQL construction triggers static analysis warnings (Bandit B608, Sourcery) and represents a maintenance risk. Logging full response bodies on failure can inadvertently leak credentials if the upstream server reflects them or contains other PII.
Additionally, authentication failures can lead to `None` session objects which must be explicitly checked before use to prevent `AttributeError` crashes, especially in CI environments where credentials might be missing.
**Prevention:** Use whitelisted static queries for dynamic table/column selection. Avoid dynamic `IN` clauses with f-strings; use multiple parameterized queries if necessary for strict security compliance. Redact sensitive fields and use content length instead of full response text in error logs for authentication-related requests. Always include standard security headers (HSTS, Referrer-Policy) to protect end-user sessions. Check for `None` sessions after login attempts.
